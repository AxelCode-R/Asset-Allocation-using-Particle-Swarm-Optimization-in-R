<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Particle Swarm Optimization (PSO) | Master-Thesis</title>
  <meta name="description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.28.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Particle Swarm Optimization (PSO) | Master-Thesis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="AxelCode-R/Master-Thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Particle Swarm Optimization (PSO) | Master-Thesis" />
  
  <meta name="twitter:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Axel Roth" />


<meta name="date" content="2022-09-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analytic-solver-for-quadratic-programming-problems.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="my_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Master Thesis Axel Roth</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html"><i class="fa fa-check"></i><b>2</b> Software information and usage</a>
<ul>
<li class="chapter" data-level="2.1" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-version-and-packages"><i class="fa fa-check"></i><b>2.1</b> R-Version and Packages</a></li>
<li class="chapter" data-level="2.2" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#reproducibility"><i class="fa fa-check"></i><b>2.2</b> Reproducibility</a></li>
<li class="chapter" data-level="2.3" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-functions"><i class="fa fa-check"></i><b>2.3</b> R-functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="open-data-sources.html"><a href="open-data-sources.html"><i class="fa fa-check"></i><b>3</b> Open Data Sources</a>
<ul>
<li class="chapter" data-level="3.1" data-path="open-data-sources.html"><a href="open-data-sources.html#r-functions-1"><i class="fa fa-check"></i><b>3.1</b> R-Functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathfundations.html"><a href="mathfundations.html"><i class="fa fa-check"></i><b>4</b> Mathematical Fundations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathfundations.html"><a href="mathfundations.html#basic-operators"><i class="fa fa-check"></i><b>4.1</b> Basic Operators</a></li>
<li class="chapter" data-level="4.2" data-path="mathfundations.html"><a href="mathfundations.html#return-calculation"><i class="fa fa-check"></i><b>4.2</b> Return Calculation</a></li>
<li class="chapter" data-level="4.3" data-path="mathfundations.html"><a href="mathfundations.html#markowitz-modern-portfolio-theory-mpt"><i class="fa fa-check"></i><b>4.3</b> Markowitz Modern Portfolio Theory (MPT)</a></li>
<li class="chapter" data-level="4.4" data-path="mathfundations.html"><a href="mathfundations.html#portfolio-math"><i class="fa fa-check"></i><b>4.4</b> Portfolio Math</a></li>
<li class="chapter" data-level="4.5" data-path="mathfundations.html"><a href="mathfundations.html#r-functions-2"><i class="fa fa-check"></i><b>4.5</b> R-Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="activ-vs-passiv-investing.html"><a href="activ-vs-passiv-investing.html"><i class="fa fa-check"></i><b>5</b> Activ vs Passiv Investing</a></li>
<li class="chapter" data-level="6" data-path="challenges.html"><a href="challenges.html"><i class="fa fa-check"></i><b>6</b> Challenges of Passiv Investing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="challenges.html"><a href="challenges.html#mean-variance-portfolio-mvp"><i class="fa fa-check"></i><b>6.1</b> Mean-Variance Portfolio (MVP)</a></li>
<li class="chapter" data-level="6.2" data-path="challenges.html"><a href="challenges.html#index-tracking-portfolio-itp"><i class="fa fa-check"></i><b>6.2</b> Index-Tracking Portfolio (ITP)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html"><i class="fa fa-check"></i><b>7</b> Analytic Solver for Quadratic Programming Problems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#quadratic-programming-qp"><i class="fa fa-check"></i><b>7.1</b> Quadratic Programming (QP)</a></li>
<li class="chapter" data-level="7.2" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#qp-solver-from-quadprog"><i class="fa fa-check"></i><b>7.2</b> QP Solver from quadprog</a></li>
<li class="chapter" data-level="7.3" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#exampleanalyticalmvp"><i class="fa fa-check"></i><b>7.3</b> Example: Solving MVP with <code>solve.QP()</code></a></li>
<li class="chapter" data-level="7.4" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#example-solving-itp-with-solve.qp"><i class="fa fa-check"></i><b>7.4</b> Example: Solving ITP with <code>solve.QP()</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html"><i class="fa fa-check"></i><b>8</b> Particle Swarm Optimization (PSO)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#the-algorithm"><i class="fa fa-check"></i><b>8.1</b> The Algorithm</a></li>
<li class="chapter" data-level="8.2" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#pso-function"><i class="fa fa-check"></i><b>8.2</b> <code>pso()</code> Function</a></li>
<li class="chapter" data-level="8.3" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#animation-2-dimensional"><i class="fa fa-check"></i><b>8.3</b> Animation 2-Dimensional</a></li>
<li class="chapter" data-level="8.4" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#example-mvp"><i class="fa fa-check"></i><b>8.4</b> Example MVP</a></li>
<li class="chapter" data-level="8.5" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#example-itp-1"><i class="fa fa-check"></i><b>8.5</b> Example ITP</a></li>
<li class="chapter" data-level="8.6" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#pros-and-cons"><i class="fa fa-check"></i><b>8.6</b> Pros and Cons</a></li>
<li class="chapter" data-level="8.7" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#functions"><i class="fa fa-check"></i><b>8.7</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/AxelCode-R/Master-Thesis" target="blank">GitHub Repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Master-Thesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="particle-swarm-optimization-pso" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Particle Swarm Optimization (PSO)<a href="particle-swarm-optimization-pso.html#particle-swarm-optimization-pso" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The PSO was developed by J. Kennedy as a Global Optimization method based on Swarm Intelligence and was introduced to the public in 1995 by Eberhart and Kennedy <span class="citation">(<a href="#ref-KeEb1995" role="doc-biblioref">James Kennedy 1995</a>)</span>. The initial PSO should resemble a flock of birds, that is flying through the sky without collisions. That is why its first applications were found in particle physics, to analyse moving particles in high dimensional spaces, which is resembled in the name Particle. Afterwards it was adapted in Evolutionary Computation to exploit a set of potential solutions in high dimensions and find the optima by cooperation with other particles in the swarm <span class="citation">(<a href="#ref-PaVr2002" role="doc-biblioref">Konstantinos Parsopoulos 2002</a>)</span>. The benefits compared to some other Global Optimization methods are the fact that no gradient information is needed. It can find the optimum by considering only the result of the function that needs to be optimized. That means that the function can be arbitrarily complex and its still possible to reach the global optimum. Other benefits are the low computational costs, because only basic mathematical operators are used.</p>
<div id="the-algorithm" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> The Algorithm<a href="particle-swarm-optimization-pso.html#the-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Each Particle <span class="math inline">\(d\)</span> with position <span class="math inline">\(x_d\)</span> moves in the search space <span class="math inline">\(R^N\)</span> and has its inherent velocity <span class="math inline">\(v_d\)</span> and remembers its previous best position <span class="math inline">\(P_d\)</span>. After each iteration the velocity changes into the direction of its inherent velocity, its best previous position and the global best position <span class="math inline">\(p_g\)</span> of all particles. A position change from <span class="math inline">\(i\)</span> to <span class="math inline">\(i+1\)</span> can be calculated by the following two equations <span class="citation">(<a href="#ref-PaVr2002" role="doc-biblioref">Konstantinos Parsopoulos 2002</a>)</span>:</p>
<p><span class="math display">\[\begin{align*}
  v_d^{i+1} &amp;= wv_d^{i} + c_p r_1^i (P_d^i-x_d^i) + c_g r_2^i (p_g^i - x_d^i) \\
  x_d^{i+1} &amp;= x_d^i + v_d^{i+1}
\end{align*}\]</span></p>
<p>with <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> being uniformly distributed random numbers in [0, 1]. The cognitive parameter <span class="math inline">\(c_p\)</span> acts as the weighting of the direction to its previous best position of the particle. On the contrary is the social parameter <span class="math inline">\(c_g\)</span>, which is a weighting to the direction of the global best position. The inertia weight <span class="math inline">\(w\)</span> is crucial for the convergence behavior by remembering a part of its previous trajectory. A study examined in <span class="citation">(<a href="#ref-PaVr2002" role="doc-biblioref">Konstantinos Parsopoulos 2002</a>)</span> showed that these parameters can be set to <span class="math inline">\(c_p=c_g=0.5\)</span> and <span class="math inline">\(w\)</span> should decrease from <span class="math inline">\(1.2\)</span> to <span class="math inline">\(0\)</span>. However, some problems do benefit from more fine-tuning of these parameters. To provide a effortless translation to code, the formula above can be stated for <span class="math inline">\(d = 1, 2, \cdots, D\)</span> particles in the following matrix notation:
<span class="math display">\[
  V^{i+1} = w \cdot V^{i} + c_1 \cdot r_1^i \cdot (P^i-X^i) + c_2 \cdot r_2^i \cdot (p_g^i - X^i) \\
  X^{i+1} = X^i + V^{i+1}
\]</span>
with current positions <span class="math inline">\(X \in R^{N \times D}\)</span>, current velocity’s <span class="math inline">\(V \in R^{N \times D}\)</span>, previous best positions <span class="math inline">\(P \in R^{N \times D}\)</span> and the global best position <span class="math inline">\(p_g \in R^{N}\)</span>. The parameters <span class="math inline">\(w\)</span>, <span class="math inline">\(c_p\)</span>, <span class="math inline">\(c_g\)</span>, <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> are stile scalars.</p>
</div>
<div id="pso-function" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> <code>pso()</code> Function<a href="particle-swarm-optimization-pso.html#pso-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A general purpose PSO function is created in this section by following the structure of other optimization heuristics in R, specially the existing PSO implementation from the R-Package <code>pso</code>. The center of everything is a objective function <code>fn()</code> which will return a scalar that needs to be minimized. The function itself needs mainly a vector <code>pos</code> that describes the position of a particle (e.g. weights). The other main parameters for the PSO function are <code>par</code>, which is one position of a particle, that is used to derive the dimension of the problem and used as first position of one particle. The argument can contain only <code>NA</code>’s which results in completely randomized starting positions. The last two arguments needed are <code>lower</code> and <code>upper</code> bounds (e.g. weights bigger than 0 and smaller than 1). All other parameters have default values that can be overwritten by passing a list named <code>control</code>. The resulting structure is:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="particle-swarm-optimization-pso.html#cb20-1" aria-hidden="true" tabindex="-1"></a>pso <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb20-2"><a href="particle-swarm-optimization-pso.html#cb20-2" aria-hidden="true" tabindex="-1"></a>    par, </span>
<span id="cb20-3"><a href="particle-swarm-optimization-pso.html#cb20-3" aria-hidden="true" tabindex="-1"></a>    fn, </span>
<span id="cb20-4"><a href="particle-swarm-optimization-pso.html#cb20-4" aria-hidden="true" tabindex="-1"></a>    lower, </span>
<span id="cb20-5"><a href="particle-swarm-optimization-pso.html#cb20-5" aria-hidden="true" tabindex="-1"></a>    upper, </span>
<span id="cb20-6"><a href="particle-swarm-optimization-pso.html#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>()</span>
<span id="cb20-7"><a href="particle-swarm-optimization-pso.html#cb20-7" aria-hidden="true" tabindex="-1"></a>  ){</span>
<span id="cb20-8"><a href="particle-swarm-optimization-pso.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="particle-swarm-optimization-pso.html#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Before the main data-structure can be initialized, its necessary to create some example inputs for the <code>pso()</code> function like below:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="particle-swarm-optimization-pso.html#cb21-1" aria-hidden="true" tabindex="-1"></a>par <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">2</span>)</span>
<span id="cb21-2"><a href="particle-swarm-optimization-pso.html#cb21-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(x)))}</span>
<span id="cb21-3"><a href="particle-swarm-optimization-pso.html#cb21-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb21-4"><a href="particle-swarm-optimization-pso.html#cb21-4" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb21-5"><a href="particle-swarm-optimization-pso.html#cb21-5" aria-hidden="true" tabindex="-1"></a>control <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb21-6"><a href="particle-swarm-optimization-pso.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s =</span> <span class="dv">10</span>, <span class="co"># swarm size</span></span>
<span id="cb21-7"><a href="particle-swarm-optimization-pso.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">c.p =</span> <span class="fl">0.5</span>, <span class="co"># inherit best</span></span>
<span id="cb21-8"><a href="particle-swarm-optimization-pso.html#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">c.g =</span> <span class="fl">0.5</span>, <span class="co"># global best</span></span>
<span id="cb21-9"><a href="particle-swarm-optimization-pso.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">100</span>, <span class="co"># iterations</span></span>
<span id="cb21-10"><a href="particle-swarm-optimization-pso.html#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">w0 =</span> <span class="fl">1.2</span>, <span class="co"># starting inertia weight</span></span>
<span id="cb21-11"><a href="particle-swarm-optimization-pso.html#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">wN =</span> <span class="dv">0</span>, <span class="co"># ending inertia weight</span></span>
<span id="cb21-12"><a href="particle-swarm-optimization-pso.html#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_traces =</span> F <span class="co"># save more information</span></span>
<span id="cb21-13"><a href="particle-swarm-optimization-pso.html#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now is the time to initialize the random positions <code>X</code>, its fitness <code>X_fit</code> and its random velocity’s <code>V</code> with the function <code>mrunif()</code>, which will create a matrix from uniformly distributed random numbers between <code>lower</code> and <code>upper</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="particle-swarm-optimization-pso.html#cb22-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">mrunif</span>(</span>
<span id="cb22-2"><a href="particle-swarm-optimization-pso.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nr =</span> <span class="fu">length</span>(par), <span class="at">nc=</span>control<span class="sc">$</span>s, <span class="at">lower=</span>lower, <span class="at">upper=</span>upper</span>
<span id="cb22-3"><a href="particle-swarm-optimization-pso.html#cb22-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-4"><a href="particle-swarm-optimization-pso.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(par))){</span>
<span id="cb22-5"><a href="particle-swarm-optimization-pso.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  X[, <span class="dv">1</span>] <span class="ot">&lt;-</span> par</span>
<span id="cb22-6"><a href="particle-swarm-optimization-pso.html#cb22-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-7"><a href="particle-swarm-optimization-pso.html#cb22-7" aria-hidden="true" tabindex="-1"></a>X_fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, fn)</span>
<span id="cb22-8"><a href="particle-swarm-optimization-pso.html#cb22-8" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">mrunif</span>(</span>
<span id="cb22-9"><a href="particle-swarm-optimization-pso.html#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nr =</span> <span class="fu">length</span>(par), <span class="at">nc=</span>control<span class="sc">$</span>s, </span>
<span id="cb22-10"><a href="particle-swarm-optimization-pso.html#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower=</span><span class="sc">-</span>(upper<span class="sc">-</span>lower), <span class="at">upper=</span>(upper<span class="sc">-</span>lower)</span>
<span id="cb22-11"><a href="particle-swarm-optimization-pso.html#cb22-11" aria-hidden="true" tabindex="-1"></a>)<span class="sc">/</span><span class="dv">4</span></span></code></pre></div>
<p>The velocity’s are compressed with factor 4 to start with a maximal movement from a quarter of the space in each axis. The personal best positions <code>P</code> are the same as <code>X</code> and the global best position is the position with the smallest fitness:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="particle-swarm-optimization-pso.html#cb23-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> X</span>
<span id="cb23-2"><a href="particle-swarm-optimization-pso.html#cb23-2" aria-hidden="true" tabindex="-1"></a>P_fit <span class="ot">&lt;-</span> X_fit</span>
<span id="cb23-3"><a href="particle-swarm-optimization-pso.html#cb23-3" aria-hidden="true" tabindex="-1"></a>p_g <span class="ot">&lt;-</span> P[, <span class="fu">which.min</span>(P_fit)]</span>
<span id="cb23-4"><a href="particle-swarm-optimization-pso.html#cb23-4" aria-hidden="true" tabindex="-1"></a>p_g_fit <span class="ot">&lt;-</span> <span class="fu">which.min</span>(P_fit)</span></code></pre></div>
<p>The needed data-structure is present and the optimization can start by calculating the new velocity’s and the transformation of the old positions. If particles have left the valid space, they get pushed back to the border. Afterwards the fitness is calculated and the personal best and global best positions are saved, if they have improved.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="particle-swarm-optimization-pso.html#cb24-1" aria-hidden="true" tabindex="-1"></a>trace_data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-2"><a href="particle-swarm-optimization-pso.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>control<span class="sc">$</span>maxiter){</span>
<span id="cb24-3"><a href="particle-swarm-optimization-pso.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># move particles</span></span>
<span id="cb24-4"><a href="particle-swarm-optimization-pso.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> </span>
<span id="cb24-5"><a href="particle-swarm-optimization-pso.html#cb24-5" aria-hidden="true" tabindex="-1"></a>    (control<span class="sc">$</span>w0<span class="sc">-</span>(control<span class="sc">$</span>w0<span class="sc">-</span>control<span class="sc">$</span>wN)<span class="sc">*</span>i<span class="sc">/</span>control<span class="sc">$</span>maxiter) <span class="sc">*</span> V <span class="sc">+</span> </span>
<span id="cb24-6"><a href="particle-swarm-optimization-pso.html#cb24-6" aria-hidden="true" tabindex="-1"></a>    control<span class="sc">$</span>c.p <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> (P<span class="sc">-</span>X) <span class="sc">+</span> </span>
<span id="cb24-7"><a href="particle-swarm-optimization-pso.html#cb24-7" aria-hidden="true" tabindex="-1"></a>    control<span class="sc">$</span>c.g <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> (p_g<span class="sc">-</span>X)</span>
<span id="cb24-8"><a href="particle-swarm-optimization-pso.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X <span class="sc">+</span> V</span>
<span id="cb24-9"><a href="particle-swarm-optimization-pso.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="particle-swarm-optimization-pso.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set velocity to zeros if not in valid space</span></span>
<span id="cb24-11"><a href="particle-swarm-optimization-pso.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  V[X <span class="sc">&gt;</span> upper] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-12"><a href="particle-swarm-optimization-pso.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  V[X <span class="sc">&lt;</span> lower] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-13"><a href="particle-swarm-optimization-pso.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-14"><a href="particle-swarm-optimization-pso.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># move into valid space</span></span>
<span id="cb24-15"><a href="particle-swarm-optimization-pso.html#cb24-15" aria-hidden="true" tabindex="-1"></a>  X[X <span class="sc">&gt;</span> upper] <span class="ot">&lt;-</span> upper</span>
<span id="cb24-16"><a href="particle-swarm-optimization-pso.html#cb24-16" aria-hidden="true" tabindex="-1"></a>  X[X <span class="sc">&lt;</span> lower] <span class="ot">&lt;-</span> lower</span>
<span id="cb24-17"><a href="particle-swarm-optimization-pso.html#cb24-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-18"><a href="particle-swarm-optimization-pso.html#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># evaluate objective function</span></span>
<span id="cb24-19"><a href="particle-swarm-optimization-pso.html#cb24-19" aria-hidden="true" tabindex="-1"></a>  X_fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, fn)</span>
<span id="cb24-20"><a href="particle-swarm-optimization-pso.html#cb24-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-21"><a href="particle-swarm-optimization-pso.html#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save new previews best</span></span>
<span id="cb24-22"><a href="particle-swarm-optimization-pso.html#cb24-22" aria-hidden="true" tabindex="-1"></a>  P[, P_fit <span class="sc">&gt;</span> X_fit] <span class="ot">&lt;-</span> X[, P_fit <span class="sc">&gt;</span> X_fit]</span>
<span id="cb24-23"><a href="particle-swarm-optimization-pso.html#cb24-23" aria-hidden="true" tabindex="-1"></a>  P_fit[P_fit <span class="sc">&gt;</span> X_fit] <span class="ot">&lt;-</span> X_fit[P_fit <span class="sc">&gt;</span> X_fit]</span>
<span id="cb24-24"><a href="particle-swarm-optimization-pso.html#cb24-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-25"><a href="particle-swarm-optimization-pso.html#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save new global best</span></span>
<span id="cb24-26"><a href="particle-swarm-optimization-pso.html#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(P_fit <span class="sc">&lt;</span> p_g_fit)){</span>
<span id="cb24-27"><a href="particle-swarm-optimization-pso.html#cb24-27" aria-hidden="true" tabindex="-1"></a>    p_g <span class="ot">&lt;-</span> P[, <span class="fu">which.min</span>(P_fit)]</span>
<span id="cb24-28"><a href="particle-swarm-optimization-pso.html#cb24-28" aria-hidden="true" tabindex="-1"></a>    p_g_fit <span class="ot">&lt;-</span> <span class="fu">min</span>(P_fit)</span>
<span id="cb24-29"><a href="particle-swarm-optimization-pso.html#cb24-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-30"><a href="particle-swarm-optimization-pso.html#cb24-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-31"><a href="particle-swarm-optimization-pso.html#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(control<span class="sc">$</span>save_traces<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb24-32"><a href="particle-swarm-optimization-pso.html#cb24-32" aria-hidden="true" tabindex="-1"></a>    trace_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(trace_data, <span class="fu">data.frame</span>(<span class="st">&quot;iter&quot;</span><span class="ot">=</span>i, <span class="fu">t</span>(X)))</span>
<span id="cb24-33"><a href="particle-swarm-optimization-pso.html#cb24-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-34"><a href="particle-swarm-optimization-pso.html#cb24-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The best fitness after <span class="math inline">\(100\)</span> iterations is 0.0000019 and the best possible solution is at <span class="math inline">\(0\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code_fold_it_collapsed"><code class="sourceCode r"><span id="cb25-1"><a href="particle-swarm-optimization-pso.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the resulting pso() function</span></span>
<span id="cb25-2"><a href="particle-swarm-optimization-pso.html#cb25-2" aria-hidden="true" tabindex="-1"></a>pso <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb25-3"><a href="particle-swarm-optimization-pso.html#cb25-3" aria-hidden="true" tabindex="-1"></a>    par, </span>
<span id="cb25-4"><a href="particle-swarm-optimization-pso.html#cb25-4" aria-hidden="true" tabindex="-1"></a>    fn, </span>
<span id="cb25-5"><a href="particle-swarm-optimization-pso.html#cb25-5" aria-hidden="true" tabindex="-1"></a>    lower, </span>
<span id="cb25-6"><a href="particle-swarm-optimization-pso.html#cb25-6" aria-hidden="true" tabindex="-1"></a>    upper, </span>
<span id="cb25-7"><a href="particle-swarm-optimization-pso.html#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>()</span>
<span id="cb25-8"><a href="particle-swarm-optimization-pso.html#cb25-8" aria-hidden="true" tabindex="-1"></a>  ){</span>
<span id="cb25-9"><a href="particle-swarm-optimization-pso.html#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="particle-swarm-optimization-pso.html#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use default control values if not set</span></span>
<span id="cb25-11"><a href="particle-swarm-optimization-pso.html#cb25-11" aria-hidden="true" tabindex="-1"></a>  control_ <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb25-12"><a href="particle-swarm-optimization-pso.html#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="dv">10</span>, <span class="co"># swarm size</span></span>
<span id="cb25-13"><a href="particle-swarm-optimization-pso.html#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.p =</span> <span class="fl">0.5</span>, <span class="co"># inherit best</span></span>
<span id="cb25-14"><a href="particle-swarm-optimization-pso.html#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">c.g =</span> <span class="fl">0.5</span>, <span class="co"># global best</span></span>
<span id="cb25-15"><a href="particle-swarm-optimization-pso.html#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">200</span>, <span class="co"># iterations</span></span>
<span id="cb25-16"><a href="particle-swarm-optimization-pso.html#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">w0 =</span> <span class="fl">1.2</span>, <span class="co"># starting inertia weight</span></span>
<span id="cb25-17"><a href="particle-swarm-optimization-pso.html#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wN =</span> <span class="dv">0</span>, <span class="co"># ending inertia weight</span></span>
<span id="cb25-18"><a href="particle-swarm-optimization-pso.html#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_traces =</span> F <span class="co"># save more information</span></span>
<span id="cb25-19"><a href="particle-swarm-optimization-pso.html#cb25-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-20"><a href="particle-swarm-optimization-pso.html#cb25-20" aria-hidden="true" tabindex="-1"></a>  control <span class="ot">&lt;-</span> <span class="fu">c</span>(control, control_[<span class="sc">!</span><span class="fu">names</span>(control_) <span class="sc">%in%</span> <span class="fu">names</span>(control)])</span>
<span id="cb25-21"><a href="particle-swarm-optimization-pso.html#cb25-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-22"><a href="particle-swarm-optimization-pso.html#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># init data-structure</span></span>
<span id="cb25-23"><a href="particle-swarm-optimization-pso.html#cb25-23" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">mrunif</span>(</span>
<span id="cb25-24"><a href="particle-swarm-optimization-pso.html#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">nr =</span> <span class="fu">length</span>(par), <span class="at">nc=</span>control<span class="sc">$</span>s, <span class="at">lower=</span>lower, <span class="at">upper=</span>upper</span>
<span id="cb25-25"><a href="particle-swarm-optimization-pso.html#cb25-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-26"><a href="particle-swarm-optimization-pso.html#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(par))){</span>
<span id="cb25-27"><a href="particle-swarm-optimization-pso.html#cb25-27" aria-hidden="true" tabindex="-1"></a>    X[, <span class="dv">1</span>] <span class="ot">&lt;-</span> par</span>
<span id="cb25-28"><a href="particle-swarm-optimization-pso.html#cb25-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-29"><a href="particle-swarm-optimization-pso.html#cb25-29" aria-hidden="true" tabindex="-1"></a>  X_fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, fn)</span>
<span id="cb25-30"><a href="particle-swarm-optimization-pso.html#cb25-30" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">mrunif</span>(</span>
<span id="cb25-31"><a href="particle-swarm-optimization-pso.html#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">nr =</span> <span class="fu">length</span>(par), <span class="at">nc=</span>control<span class="sc">$</span>s, </span>
<span id="cb25-32"><a href="particle-swarm-optimization-pso.html#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower=</span><span class="sc">-</span>(upper<span class="sc">-</span>lower), <span class="at">upper=</span>(upper<span class="sc">-</span>lower)</span>
<span id="cb25-33"><a href="particle-swarm-optimization-pso.html#cb25-33" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb25-34"><a href="particle-swarm-optimization-pso.html#cb25-34" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">&lt;-</span> X</span>
<span id="cb25-35"><a href="particle-swarm-optimization-pso.html#cb25-35" aria-hidden="true" tabindex="-1"></a>  P_fit <span class="ot">&lt;-</span> X_fit</span>
<span id="cb25-36"><a href="particle-swarm-optimization-pso.html#cb25-36" aria-hidden="true" tabindex="-1"></a>  p_g <span class="ot">&lt;-</span> P[, <span class="fu">which.min</span>(P_fit)]</span>
<span id="cb25-37"><a href="particle-swarm-optimization-pso.html#cb25-37" aria-hidden="true" tabindex="-1"></a>  p_g_fit <span class="ot">&lt;-</span> <span class="fu">which.min</span>(P_fit)</span>
<span id="cb25-38"><a href="particle-swarm-optimization-pso.html#cb25-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-39"><a href="particle-swarm-optimization-pso.html#cb25-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-40"><a href="particle-swarm-optimization-pso.html#cb25-40" aria-hidden="true" tabindex="-1"></a>  trace_data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb25-41"><a href="particle-swarm-optimization-pso.html#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>control<span class="sc">$</span>maxiter){</span>
<span id="cb25-42"><a href="particle-swarm-optimization-pso.html#cb25-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-43"><a href="particle-swarm-optimization-pso.html#cb25-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move particles</span></span>
<span id="cb25-44"><a href="particle-swarm-optimization-pso.html#cb25-44" aria-hidden="true" tabindex="-1"></a>    V <span class="ot">&lt;-</span> </span>
<span id="cb25-45"><a href="particle-swarm-optimization-pso.html#cb25-45" aria-hidden="true" tabindex="-1"></a>      (control<span class="sc">$</span>w0<span class="sc">-</span>(control<span class="sc">$</span>w0<span class="sc">-</span>control<span class="sc">$</span>wN)<span class="sc">*</span>i<span class="sc">/</span>control<span class="sc">$</span>maxiter) <span class="sc">*</span> V <span class="sc">+</span> </span>
<span id="cb25-46"><a href="particle-swarm-optimization-pso.html#cb25-46" aria-hidden="true" tabindex="-1"></a>      control<span class="sc">$</span>c.p <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> (P<span class="sc">-</span>X) <span class="sc">+</span> </span>
<span id="cb25-47"><a href="particle-swarm-optimization-pso.html#cb25-47" aria-hidden="true" tabindex="-1"></a>      control<span class="sc">$</span>c.g <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> (p_g<span class="sc">-</span>X)</span>
<span id="cb25-48"><a href="particle-swarm-optimization-pso.html#cb25-48" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X <span class="sc">+</span> V</span>
<span id="cb25-49"><a href="particle-swarm-optimization-pso.html#cb25-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-50"><a href="particle-swarm-optimization-pso.html#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set velocity to zeros if not in valid space</span></span>
<span id="cb25-51"><a href="particle-swarm-optimization-pso.html#cb25-51" aria-hidden="true" tabindex="-1"></a>    V[X <span class="sc">&gt;</span> upper] <span class="ot">&lt;-</span> <span class="sc">-</span>V[X <span class="sc">&gt;</span> upper]</span>
<span id="cb25-52"><a href="particle-swarm-optimization-pso.html#cb25-52" aria-hidden="true" tabindex="-1"></a>    V[X <span class="sc">&lt;</span> lower] <span class="ot">&lt;-</span> <span class="sc">-</span>V[X <span class="sc">&lt;</span> lower]</span>
<span id="cb25-53"><a href="particle-swarm-optimization-pso.html#cb25-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-54"><a href="particle-swarm-optimization-pso.html#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move into valid space</span></span>
<span id="cb25-55"><a href="particle-swarm-optimization-pso.html#cb25-55" aria-hidden="true" tabindex="-1"></a>    X[X <span class="sc">&gt;</span> upper] <span class="ot">&lt;-</span> upper</span>
<span id="cb25-56"><a href="particle-swarm-optimization-pso.html#cb25-56" aria-hidden="true" tabindex="-1"></a>    X[X <span class="sc">&lt;</span> lower] <span class="ot">&lt;-</span> lower</span>
<span id="cb25-57"><a href="particle-swarm-optimization-pso.html#cb25-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-58"><a href="particle-swarm-optimization-pso.html#cb25-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># evaluate objective function</span></span>
<span id="cb25-59"><a href="particle-swarm-optimization-pso.html#cb25-59" aria-hidden="true" tabindex="-1"></a>    X_fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, fn)</span>
<span id="cb25-60"><a href="particle-swarm-optimization-pso.html#cb25-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-61"><a href="particle-swarm-optimization-pso.html#cb25-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save new previews best</span></span>
<span id="cb25-62"><a href="particle-swarm-optimization-pso.html#cb25-62" aria-hidden="true" tabindex="-1"></a>    P[, P_fit <span class="sc">&gt;</span> X_fit] <span class="ot">&lt;-</span> X[, P_fit <span class="sc">&gt;</span> X_fit]</span>
<span id="cb25-63"><a href="particle-swarm-optimization-pso.html#cb25-63" aria-hidden="true" tabindex="-1"></a>    P_fit[P_fit <span class="sc">&gt;</span> X_fit] <span class="ot">&lt;-</span> X_fit[P_fit <span class="sc">&gt;</span> X_fit]</span>
<span id="cb25-64"><a href="particle-swarm-optimization-pso.html#cb25-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-65"><a href="particle-swarm-optimization-pso.html#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save new global best</span></span>
<span id="cb25-66"><a href="particle-swarm-optimization-pso.html#cb25-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(P_fit <span class="sc">&lt;</span> p_g_fit)){</span>
<span id="cb25-67"><a href="particle-swarm-optimization-pso.html#cb25-67" aria-hidden="true" tabindex="-1"></a>      p_g <span class="ot">&lt;-</span> P[, <span class="fu">which.min</span>(P_fit)]</span>
<span id="cb25-68"><a href="particle-swarm-optimization-pso.html#cb25-68" aria-hidden="true" tabindex="-1"></a>      p_g_fit <span class="ot">&lt;-</span> <span class="fu">min</span>(P_fit)</span>
<span id="cb25-69"><a href="particle-swarm-optimization-pso.html#cb25-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-70"><a href="particle-swarm-optimization-pso.html#cb25-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-71"><a href="particle-swarm-optimization-pso.html#cb25-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(control<span class="sc">$</span>save_traces){</span>
<span id="cb25-72"><a href="particle-swarm-optimization-pso.html#cb25-72" aria-hidden="true" tabindex="-1"></a>      trace_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(trace_data, <span class="fu">data.frame</span>(<span class="st">&quot;iter&quot;</span><span class="ot">=</span>i, <span class="fu">t</span>(X)))</span>
<span id="cb25-73"><a href="particle-swarm-optimization-pso.html#cb25-73" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-74"><a href="particle-swarm-optimization-pso.html#cb25-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-75"><a href="particle-swarm-optimization-pso.html#cb25-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-76"><a href="particle-swarm-optimization-pso.html#cb25-76" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb25-77"><a href="particle-swarm-optimization-pso.html#cb25-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;solution&quot;</span> <span class="ot">=</span> p_g,</span>
<span id="cb25-78"><a href="particle-swarm-optimization-pso.html#cb25-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fitness&quot;</span> <span class="ot">=</span> p_g_fit</span>
<span id="cb25-79"><a href="particle-swarm-optimization-pso.html#cb25-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-80"><a href="particle-swarm-optimization-pso.html#cb25-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(control<span class="sc">$</span>save_traces){</span>
<span id="cb25-81"><a href="particle-swarm-optimization-pso.html#cb25-81" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>trace_data <span class="ot">&lt;-</span> trace_data</span>
<span id="cb25-82"><a href="particle-swarm-optimization-pso.html#cb25-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-83"><a href="particle-swarm-optimization-pso.html#cb25-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb25-84"><a href="particle-swarm-optimization-pso.html#cb25-84" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="animation-2-dimensional" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Animation 2-Dimensional<a href="particle-swarm-optimization-pso.html#animation-2-dimensional" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section provides insights into the behavior of the PSO by visualizing multiple iterations in a GIF. The GIF only works in Adobe Acrobat DC or in the Markdown/HTML Version of this thesis. The amazing template of the animation is inspired by <a href="https://www.r-bloggers.com/2021/10/how-to-build-a-basic-particle-swarm-optimiser-from-scratch-in-r/">R’tichoke</a>. The PSO core from the chapter above was used to finish the <code>pso()</code> function and is used here with seed 0. The fucntion <code>fn</code> to evaluate is they same function as in <a href="https://www.r-bloggers.com/2021/10/how-to-build-a-basic-particle-swarm-optimiser-from-scratch-in-r/">R’tichoke</a>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="particle-swarm-optimization-pso.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb26-2"><a href="particle-swarm-optimization-pso.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="particle-swarm-optimization-pso.html#cb26-3" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pos){</span>
<span id="cb26-4"><a href="particle-swarm-optimization-pso.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">20</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.5</span> <span class="sc">*</span>((pos[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (pos[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">-</span> </span>
<span id="cb26-5"><a href="particle-swarm-optimization-pso.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">0.5</span><span class="sc">*</span>(<span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>pos[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>pos[<span class="dv">2</span>]))) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="particle-swarm-optimization-pso.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb26-7"><a href="particle-swarm-optimization-pso.html#cb26-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="particle-swarm-optimization-pso.html#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="particle-swarm-optimization-pso.html#cb26-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">pso</span>(</span>
<span id="cb26-10"><a href="particle-swarm-optimization-pso.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb26-11"><a href="particle-swarm-optimization-pso.html#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> fn,</span>
<span id="cb26-12"><a href="particle-swarm-optimization-pso.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="sc">-</span><span class="dv">10</span>,</span>
<span id="cb26-13"><a href="particle-swarm-optimization-pso.html#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="dv">10</span>,</span>
<span id="cb26-14"><a href="particle-swarm-optimization-pso.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb26-15"><a href="particle-swarm-optimization-pso.html#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="dv">10</span>,</span>
<span id="cb26-16"><a href="particle-swarm-optimization-pso.html#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">30</span>,</span>
<span id="cb26-17"><a href="particle-swarm-optimization-pso.html#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">w0 =</span> <span class="fl">0.8</span>,</span>
<span id="cb26-18"><a href="particle-swarm-optimization-pso.html#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_traces =</span> T</span>
<span id="cb26-19"><a href="particle-swarm-optimization-pso.html#cb26-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-20"><a href="particle-swarm-optimization-pso.html#cb26-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The function <code>fn</code> has many local minima and a global minima at <span class="math inline">\((1,1)\)</span> with value <span class="math inline">\(0\)</span>. The background-color-scale ranges from 0 as red to 20 as purple. The PSO has 10 particles, iterates 30 times with inertia weight decreasing from 0.8 to 0. The iterations are visualized in the GIF below:</p>
<p><img src="Master_Thesis_files/figure-html/gif_animate-1.gif" /><!-- --></p>
</div>
<div id="example-mvp" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Example MVP<a href="particle-swarm-optimization-pso.html#example-mvp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This example uses the <code>solve.QP</code> approach from <a href="analytic-solver-for-quadratic-programming-problems.html#exampleanalyticalmvp">7.3</a> with ten assets as benchmark. Recap, the goal is to create a MVP from ten of the biggest american equity’s between 2016 and 2021 for each possible <span class="math inline">\(\lambda\)</span>. The PSO has 100 particles and 200 iterations for each lambda. The key features of all portfolios generated with the <code>solve.QP</code> versus the PSO is shown below:
<img src="Master_Thesis_files/figure-html/unnamed-chunk-27-1.png" width="672" />
It can be seen that the analytical approach and the PSO approach have a tiny difference for <span class="math inline">\(lambda &gt; 0.9\)</span> and a steadily increased difference otherwise. This indicates that minimum variance portfolios are more stable to generate with the PSO.</p>
</div>
<div id="example-itp-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Example ITP<a href="particle-swarm-optimization-pso.html#example-itp-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="Master_Thesis_files/figure-html/unnamed-chunk-28-1.png" width="672" />
The mean fitness</p>
</div>
<div id="pros-and-cons" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Pros and Cons<a href="particle-swarm-optimization-pso.html#pros-and-cons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="functions" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Functions<a href="particle-swarm-optimization-pso.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-KeEb1995" class="csl-entry">
James Kennedy, Russell Eberhart. 1995. <span>“Particle Swarm Optimization.”</span> <a href="https://www.cs.tufts.edu/">https://www.cs.tufts.edu/</a>.
</div>
<div id="ref-PaVr2002" class="csl-entry">
Konstantinos Parsopoulos, Michael N. Vrahatis. 2002. <span>“Recent Approaches to Global Optimization Problems Through Particle Swarm Optimization.”</span>
</div>
</div>
<script src="script.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="analytic-solver-for-quadratic-programming-problems.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AxelCode-R/Master-Thesis/edit/master/7_Simple_Particle_Swarm_Optimization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Master_Thesis.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
