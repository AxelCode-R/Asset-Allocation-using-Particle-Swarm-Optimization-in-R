<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Real Life ITP Example | Asset Allocation using Particle Swarm Optimization in R</title>
  <meta name="description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.28.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Real Life ITP Example | Asset Allocation using Particle Swarm Optimization in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="AxelCode-R/Master-Thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Real Life ITP Example | Asset Allocation using Particle Swarm Optimization in R" />
  
  <meta name="twitter:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Axel Roth" />


<meta name="date" content="2022-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pso-variations.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="my_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Master Thesis Axel Roth</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html"><i class="fa fa-check"></i><b>1</b> Software information and usage</a>
<ul>
<li class="chapter" data-level="1.1" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-version-and-packages"><i class="fa fa-check"></i><b>1.1</b> R-Version and Packages</a></li>
<li class="chapter" data-level="1.2" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#reproducibility"><i class="fa fa-check"></i><b>1.2</b> Reproducibility</a></li>
<li class="chapter" data-level="1.3" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-functions"><i class="fa fa-check"></i><b>1.3</b> R-functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="open-data-sources.html"><a href="open-data-sources.html"><i class="fa fa-check"></i><b>2</b> Open Data Sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="open-data-sources.html"><a href="open-data-sources.html#r-functions-1"><i class="fa fa-check"></i><b>2.1</b> R-Functions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="open-data-sources.html"><a href="open-data-sources.html#get_yf"><i class="fa fa-check"></i><b>2.1.1</b> <code>get_yf()</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="open-data-sources.html"><a href="open-data-sources.html#buffer"><i class="fa fa-check"></i><b>2.1.2</b> <code>buffer()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathfundations.html"><a href="mathfundations.html"><i class="fa fa-check"></i><b>3</b> Mathematical Fundations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathfundations.html"><a href="mathfundations.html#basic-operators"><i class="fa fa-check"></i><b>3.1</b> Basic Operators</a></li>
<li class="chapter" data-level="3.2" data-path="mathfundations.html"><a href="mathfundations.html#formula-conventions"><i class="fa fa-check"></i><b>3.2</b> Formula Conventions</a></li>
<li class="chapter" data-level="3.3" data-path="mathfundations.html"><a href="mathfundations.html#return-calculation"><i class="fa fa-check"></i><b>3.3</b> Return Calculation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="mathfundations.html"><a href="mathfundations.html#simple-returns"><i class="fa fa-check"></i><b>3.3.1</b> Simple Returns</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="mathfundations.html"><a href="mathfundations.html#markowitz-modern-portfolio-theory-mpt"><i class="fa fa-check"></i><b>3.4</b> Markowitz Modern Portfolio Theory (MPT)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mathfundations.html"><a href="mathfundations.html#assumptions-of-markowitz-portfolio-theory"><i class="fa fa-check"></i><b>3.4.1</b> Assumptions of Markowitz Portfolio Theory</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mathfundations.html"><a href="mathfundations.html#portfolio-math"><i class="fa fa-check"></i><b>3.5</b> Portfolio Math</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="mathfundations.html"><a href="mathfundations.html#expected-returns"><i class="fa fa-check"></i><b>3.5.1</b> Expected Returns</a></li>
<li class="chapter" data-level="3.5.2" data-path="mathfundations.html"><a href="mathfundations.html#expected-portfolio-returns"><i class="fa fa-check"></i><b>3.5.2</b> Expected Portfolio Returns</a></li>
<li class="chapter" data-level="3.5.3" data-path="mathfundations.html"><a href="mathfundations.html#covariance"><i class="fa fa-check"></i><b>3.5.3</b> Covariance</a></li>
<li class="chapter" data-level="3.5.4" data-path="mathfundations.html"><a href="mathfundations.html#portvar"><i class="fa fa-check"></i><b>3.5.4</b> Portfolio Variance</a></li>
<li class="chapter" data-level="3.5.5" data-path="mathfundations.html"><a href="mathfundations.html#portfolioreturns"><i class="fa fa-check"></i><b>3.5.5</b> Portfolio Returns</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="mathfundations.html"><a href="mathfundations.html#r-functions-2"><i class="fa fa-check"></i><b>3.6</b> R-Functions</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="mathfundations.html"><a href="mathfundations.html#covfun"><i class="fa fa-check"></i><b>3.6.1</b> <code>cov_()</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="mathfundations.html"><a href="mathfundations.html#pritoret"><i class="fa fa-check"></i><b>3.6.2</b> <code>pri_to_ret()</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="mathfundations.html"><a href="mathfundations.html#ret_to_cumret"><i class="fa fa-check"></i><b>3.6.3</b> <code>ret_to_cumret()</code></a></li>
<li class="chapter" data-level="3.6.4" data-path="mathfundations.html"><a href="mathfundations.html#geomeanret"><i class="fa fa-check"></i><b>3.6.4</b> <code>ret_to_geomeanret()</code></a></li>
<li class="chapter" data-level="3.6.5" data-path="mathfundations.html"><a href="mathfundations.html#calc_portfolio_returns"><i class="fa fa-check"></i><b>3.6.5</b> <code>calc_portfolio_returns()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="activ-vs-passiv-investing.html"><a href="activ-vs-passiv-investing.html"><i class="fa fa-check"></i><b>4</b> Activ vs Passiv Investing</a></li>
<li class="chapter" data-level="5" data-path="challenges.html"><a href="challenges.html"><i class="fa fa-check"></i><b>5</b> Challenges of Passiv Investing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="challenges.html"><a href="challenges.html#mean-variance-portfolio-mvp"><i class="fa fa-check"></i><b>5.1</b> Mean-Variance Portfolio (MVP)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="challenges.html"><a href="challenges.html#mvp-problem"><i class="fa fa-check"></i><b>5.1.1</b> MVP: Problem</a></li>
<li class="chapter" data-level="5.1.2" data-path="challenges.html"><a href="challenges.html#mvp-example"><i class="fa fa-check"></i><b>5.1.2</b> MVP: Example</a></li>
<li class="chapter" data-level="5.1.3" data-path="challenges.html"><a href="challenges.html#mvp-compare-estimators"><i class="fa fa-check"></i><b>5.1.3</b> MVP: Compare Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="challenges.html"><a href="challenges.html#index-tracking-portfolio-itp"><i class="fa fa-check"></i><b>5.2</b> Index-Tracking Portfolio (ITP)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="challenges.html"><a href="challenges.html#itp-with-tev-objective-itp-tev"><i class="fa fa-check"></i><b>5.2.1</b> ITP with TEV objective (ITP-TEV)</a></li>
<li class="chapter" data-level="5.2.2" data-path="challenges.html"><a href="challenges.html#ITPMSTE"><i class="fa fa-check"></i><b>5.2.2</b> ITP with MSTE objective (ITP-MSTE)</a></li>
<li class="chapter" data-level="5.2.3" data-path="challenges.html"><a href="challenges.html#example-itp"><i class="fa fa-check"></i><b>5.2.3</b> Example ITP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html"><i class="fa fa-check"></i><b>6</b> Analytic Solver for Quadratic Programming Problems</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#quadratic-programming-qp"><i class="fa fa-check"></i><b>6.1</b> Quadratic Programming (QP)</a></li>
<li class="chapter" data-level="6.2" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#qp-solver-from-quadprog"><i class="fa fa-check"></i><b>6.2</b> QP-Solver from quadprog</a></li>
<li class="chapter" data-level="6.3" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#exampleanalyticalmvp"><i class="fa fa-check"></i><b>6.3</b> Example: Solving MVP Problem with <code>solve.QP()</code></a></li>
<li class="chapter" data-level="6.4" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#exampleitpsolveqp"><i class="fa fa-check"></i><b>6.4</b> Example: Solving ITP-MSTE with <code>solve.QP()</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html"><i class="fa fa-check"></i><b>7</b> Particle Swarm Optimization (PSO)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#the-algorithm"><i class="fa fa-check"></i><b>7.1</b> The Algorithm</a></li>
<li class="chapter" data-level="7.2" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#pso-function"><i class="fa fa-check"></i><b>7.2</b> <code>pso()</code> Function</a></li>
<li class="chapter" data-level="7.3" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#animation-2-dimensional"><i class="fa fa-check"></i><b>7.3</b> Animation 2-Dimensional</a></li>
<li class="chapter" data-level="7.4" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#simple-constraint-handling"><i class="fa fa-check"></i><b>7.4</b> Simple Constraint Handling</a></li>
<li class="chapter" data-level="7.5" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#example-mvp"><i class="fa fa-check"></i><b>7.5</b> Example MVP</a></li>
<li class="chapter" data-level="7.6" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#example-itp-mste"><i class="fa fa-check"></i><b>7.6</b> Example: ITP-MSTE</a></li>
<li class="chapter" data-level="7.7" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#pros-and-cons-for-continuous-problems"><i class="fa fa-check"></i><b>7.7</b> Pros and Cons for Continuous Problems</a></li>
<li class="chapter" data-level="7.8" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#discrete-problems"><i class="fa fa-check"></i><b>7.8</b> Discrete Problems</a></li>
<li class="chapter" data-level="7.9" data-path="particle-swarm-optimization-pso.html"><a href="particle-swarm-optimization-pso.html#example-discrete-itp-mste"><i class="fa fa-check"></i><b>7.9</b> Example: Discrete ITP-MSTE</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pso-variations.html"><a href="pso-variations.html"><i class="fa fa-check"></i><b>8</b> PSO Variations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pso-variations.html"><a href="pso-variations.html#testproblem-discrete-itp-mste"><i class="fa fa-check"></i><b>8.1</b> Testproblem: Discrete ITP-MSTE</a></li>
<li class="chapter" data-level="8.2" data-path="pso-variations.html"><a href="pso-variations.html#function-stretching"><i class="fa fa-check"></i><b>8.2</b> Function Stretching</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="pso-variations.html"><a href="pso-variations.html#implementation"><i class="fa fa-check"></i><b>8.2.1</b> Implementation</a></li>
<li class="chapter" data-level="8.2.2" data-path="pso-variations.html"><a href="pso-variations.html#test-pso-with-function-stretching"><i class="fa fa-check"></i><b>8.2.2</b> Test PSO with Function Stretching</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="pso-variations.html"><a href="pso-variations.html#local-pso"><i class="fa fa-check"></i><b>8.3</b> Local PSO</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="pso-variations.html"><a href="pso-variations.html#implementation-1"><i class="fa fa-check"></i><b>8.3.1</b> Implementation</a></li>
<li class="chapter" data-level="8.3.2" data-path="pso-variations.html"><a href="pso-variations.html#test-local-pso"><i class="fa fa-check"></i><b>8.3.2</b> Test Local PSO</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="pso-variations.html"><a href="pso-variations.html#preserving-feasibility"><i class="fa fa-check"></i><b>8.4</b> Preserving Feasibility</a></li>
<li class="chapter" data-level="8.5" data-path="pso-variations.html"><a href="pso-variations.html#self-adaptive-velocity"><i class="fa fa-check"></i><b>8.5</b> Self-Adaptive Velocity</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="pso-variations.html"><a href="pso-variations.html#implementation-2"><i class="fa fa-check"></i><b>8.5.1</b> Implementation</a></li>
<li class="chapter" data-level="8.5.2" data-path="pso-variations.html"><a href="pso-variations.html#analyse-implementation"><i class="fa fa-check"></i><b>8.5.2</b> Analyse Implementation</a></li>
<li class="chapter" data-level="8.5.3" data-path="pso-variations.html"><a href="pso-variations.html#test-pso-with-self-adaptive-velocity"><i class="fa fa-check"></i><b>8.5.3</b> Test PSO with Self-Adaptive Velocity</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="pso-variations.html"><a href="pso-variations.html#pso-r-package"><i class="fa fa-check"></i><b>8.6</b> PSO R-Package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="real-life-itp-example.html"><a href="real-life-itp-example.html"><i class="fa fa-check"></i><b>9</b> Real Life ITP Example</a>
<ul>
<li class="chapter" data-level="9.1" data-path="real-life-itp-example.html"><a href="real-life-itp-example.html#transaction-costs"><i class="fa fa-check"></i><b>9.1</b> Transaction Costs</a></li>
<li class="chapter" data-level="9.2" data-path="real-life-itp-example.html"><a href="real-life-itp-example.html#rebalancing-constraint"><i class="fa fa-check"></i><b>9.2</b> Rebalancing Constraint</a></li>
<li class="chapter" data-level="9.3" data-path="real-life-itp-example.html"><a href="real-life-itp-example.html#objective"><i class="fa fa-check"></i><b>9.3</b> Objective</a></li>
<li class="chapter" data-level="9.4" data-path="real-life-itp-example.html"><a href="real-life-itp-example.html#complete-itp-example"><i class="fa fa-check"></i><b>9.4</b> Complete ITP Example</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>10</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/AxelCode-R/Master-Thesis" target="blank">GitHub Repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Asset Allocation using Particle Swarm Optimization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="real-life-itp-example" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Real Life ITP Example<a href="real-life-itp-example.html#real-life-itp-example" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous chapters, the capabilities of a PSO and the quality of its results were analyzed based on the solution of a problem at a single point in time. In practice, the stability of future outcomes at multiple points in time is of greater interest. Therefore, the next sections provide additional conditions needed to simulate real portfolios over multiple rebalancing time points, first by adding transaction costs to the problem. For the first rebalancing time point, a problem is defined that simulates a portfolio manager who has a certain amount of cash and attempts to construct a portfolio from it, as described in the last section. After the first iteration, the portfolio manager must sell old assets and buy new ones. This, of course, incurs additional transaction costs and effort, so most portfolio managers consider a maximum rebalancing constraint that attempts to limit the amount of assets sold and purchased. The simulation of multiple rebalancing dates is called a backtest, which attempts to simulate the performance of a portfolio as a function of the previous portfolio and the historical data of each rebalancing date. Later, a full backtest of an ITP is evaluated and analyzed in a real-world environment.</p>
<div id="transaction-costs" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Transaction Costs<a href="real-life-itp-example.html#transaction-costs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The cost of buying or selling assets must be considered as it can have a significant impact after several years of investment. There are many different costs that can be incurred depending on the concepts of the broker, the liquidity of the assets and the type of assets. For more information, see <span class="citation">(<a href="#ref-AkGa2022" role="doc-biblioref">GANTI 2022</a>)</span> or <span class="citation">(<a href="#ref-NySe2022" role="doc-biblioref">nyse.com 2022</a>)</span>. For simplicity, we focus on the situation of a retail investor using an online broker that charges a fixed fee per transaction for the U.S. stocks included in the SP500TR. Each transaction consists of one or more shares of an asset, and a transaction can be either a sale or a purchase. The fixed transaction fee is set at 1 USD, as is done by the online broker Trade Republic. The PSO can account for the transaction cost by increasing the objective value, but it is difficult to make the intensity of the transaction cost value comparable to the objective value. The objective value <span class="math inline">\(v^o\)</span> of the ITP with MSTE approach, as in <a href="challenges.html#ITPMSTE">5.2.2</a>, is defined as:
<span class="math display">\[
v^o = \left\Vert r_{p}-r_{bm} \right\Vert_2^2 = \sum_{t=1}^T (r_{t,p}-r_{t,bm})^2
\]</span>
The objective value <span class="math inline">\(v^o\)</span> is the squared tracking error or, more precisely, the squared difference of the portfolio returns <span class="math inline">\(r_p\)</span> and the benchmark returns <span class="math inline">\(r_{bm}\)</span>. To create a comparable value <span class="math inline">\(v^{tc}\)</span> for transaction costs, we attempt to interpret the absolute loss due to transactions as the absolute error of return <span class="math inline">\(r_{tc}\)</span> incurred in <span class="math inline">\(t_0\)</span> (before the first data point in <span class="math inline">\(t_1\)</span>). This absolute error <span class="math inline">\(r_{tc}\)</span> can be calculated by counting the required transactions divided by the net asset value <span class="math inline">\(nav\)</span>. The required transactions can be calculated by comparing the stock vector of the previous portfolio <span class="math inline">\(s^{prev}\)</span> and the stock vector of the rebalanced portfolio <span class="math inline">\(s^{reba}\)</span>. This results in the following formula for the absolute error return <span class="math inline">\(r_{tc}\)</span>:
<span class="math display">\[
r_{tc} = \frac{1 \cdot \sum_{n=1}^N g(s^{prev}_n-s^{reba}_n) }{nav}
\]</span>
with
<span class="math display">\[
  g(x) =    \begin{cases}
  0 &amp;\text{, if }\ x = 0\\
  1 &amp;\text{, else}
  \end{cases}
\]</span></p>
<p>This results in the following transaction costs value <span class="math inline">\(v^{tc}\)</span>:
<span class="math display">\[
v^{tc} = \left\Vert r_{tc} \right\Vert_2^2 = r_{tc}^2
\]</span></p>
<p>The idea is to use the <span class="math inline">\(v^{tc}\)</span> value and increase the objective value <span class="math inline">\(v^o\)</span> of the ITP with MSTE approach, but these values are still not the same. The <span class="math inline">\(v^o\)</span> is the sum of squared positive or negative errors and <span class="math inline">\(v^{tc}\)</span> is a squared negative error. To increase the impact of the transaction cost, a coefficient <span class="math inline">\(k\)</span> should increase the intensity, which leads to the following minimization problem:
<span class="math display">\[
  min \ \  v^o + k \cdot v^{tc}
\]</span>
A suitable value for <span class="math inline">\(k\)</span> could be calculated by dividing the number of training days by the number of days in the holding period increased by a factor of <span class="math inline">\(2.5\)</span>. This can be roughly interpreted as weighting the transaction cost error as the <span class="math inline">\(2.5\)</span>-day error in the test period. For example, a 4-month training period with 96 working days and a holding period of 1 month with 24 working days yields the following value:
<span class="math display">\[
  k = \frac{96}{24} \cdot 2.5 = 10
\]</span>
When the holding period is shortened, the intensity coefficient increases, which is a suitable behavior. Nevertheless, it should be analyzed and fine-tuned more.</p>
</div>
<div id="rebalancing-constraint" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Rebalancing Constraint<a href="real-life-itp-example.html#rebalancing-constraint" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The rebalancing constraint restricts the changes in weights by considering the previous portfolio weight vector <span class="math inline">\(w^{prev}\)</span>, which is recalculated using the previous shares vector and the rebalanced portfolio weight vector <span class="math inline">\(w^{reba}\)</span>. The value constrained by the rebalancing constraint should take into account the weights moved between assets and additional weights added. Example: the previous portfolio had a weight vector <span class="math inline">\(w^{prev} = [0.5, 0.4]\)</span> as of the current rebalancing date and the rebalanced portfolio has a weight vector <span class="math inline">\(w^{reba} = [0.8, 0.2]\)</span>. The rebalanced weight from the second to the first asset is <span class="math inline">\(0.2\)</span> and the additional weight added is <span class="math inline">\(0.1\)</span>, resulting in a rebalance of <span class="math inline">\(0.2+0.1=0.3\)</span> weight. Below is the formula for calculating the rebalancing weight <span class="math inline">\(w^{rb}\)</span>:
<span class="math display">\[
  w^{rb} := \frac{\left\Vert w^{prev}-w^{reba} \right\Vert_1 - |\sum w^{prev} - \sum w^{reba}|}{2}+|\sum w^{prev} - \sum w^{reba}|
\]</span>
and with a rebalancing constraint of, say, 30%, the rebalanced portfolio is feasible if:
<span class="math display">\[
  w^{rb} \leq 0.3
\]</span></p>
</div>
<div id="objective" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Objective<a href="real-life-itp-example.html#objective" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal is to simulate a tracking portfolio that tracks the SP500TR with a pool of 100 assets included in SP500TR over multiple rebalancing dates between 2016-05-01 and 2022-10-27 with one-month intervals. The pool of assets is created for each rebalancing date using the solve.QP() approach, continuously discarding assets as in <a href="analytic-solver-for-quadratic-programming-problems.html#exampleitpsolveqp">6.4</a>, with a maximum of 10 assets changing on each rebalancing date to reduce forced rebalancing. All considered assets have no missing values in the training period. In addition, the solve.QP() approach serves as a benchmark and the continuous solution is used as a particle position for the first rebalancing date. The tracking portfolio is solved using the self-adaptive velocity PSO from the last chapter, which gives stable results. The tracking portfolio has the following constraints: discrete number of stocks, long only, maximum weight of 10%, <span class="math inline">\(0.96 \leq \sum w_i \leq 0.995\)</span>, rebalancing under 30% weight, considering transaction cost with diffrent values for <span class="math inline">\(k\)</span>, net asset value of 20000 USD, length of training period of four months and testing period of one month.</p>
<p>Each PSO run uses 100 particles and iterates 100 times. The PSO is repeated until the constraints are satisfied. Then it is run four more times to improve the quality of the feasible solution. Each rebalancing portfolio is simulated with the portfolio return function from <a href="mathfundations.html#portfolioreturns">3.5.5</a> until the next rebalancing date. In each step the weights and shares of the tracking portfolio are calculated and the shares are used to calculate the weights at the next rebalancing date. If assets are missing in the next asset pool, they are sold and reduce the net asset value due to transaction costs. The same is done by buying or selling any remaining assets. A rough illustration of the process can be found in the following figure:</p>
<div class="figure">
<img src="img/Chapter9_PSO_Process4.jpg" alt="" />
<p class="caption">Backtest Process</p>
</div>
</div>
<div id="complete-itp-example" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Complete ITP Example<a href="real-life-itp-example.html#complete-itp-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following charts visualize the test period of the whole backtests. The <code>QP_MSTE_cont</code> line represents the performance of the continuous solution using the ITP MSTE approach solved with solve.QP() and stays the same for all backtests. The discretized solution using the PSO is named <code>PSO_MSTE_disc</code> and the <code>PSO_MSTE_disc_TE</code> considers all transaction costs in its performance. Everything is compared to the SP500TR which is the objective to track. Furthermore there are used different values for the transaction costs intensity <span class="math inline">\(k \in \{0, 10, 20, 30\}\)</span> of each backtest which can be seen in the legends by <code>0tc</code>, <code>10tc</code>, <code>20tc</code> and <code>30tc</code>.</p>
<p>Backtest for <span class="math inline">\(k=0\)</span>:</p>
<p><img src="Master_Thesis_files/figure-html/9_3-1.png" width="672" />
and the statistics of the discretized PSO with considered transaction costs are:</p>
<p><img src="Master_Thesis_files/figure-html/9_4-1.png" width="672" /></p>
<p>Backtest for <span class="math inline">\(k=10\)</span>:<br />
<img src="Master_Thesis_files/figure-html/9_5-1.png" width="672" /></p>
<p>and the statistics of the discretized PSO with considered transaction costs are:<br />
<img src="Master_Thesis_files/figure-html/9_6-1.png" width="672" /></p>
<p>Backtest for <span class="math inline">\(k=20\)</span>:<br />
<img src="Master_Thesis_files/figure-html/9_7-1.png" width="672" /></p>
<p>and the statistics of the discretized PSO with considered transaction costs are:<br />
<img src="Master_Thesis_files/figure-html/9_8-1.png" width="672" /></p>
<p>Backtest for <span class="math inline">\(k=20\)</span>:<br />
<img src="Master_Thesis_files/figure-html/9_9-1.png" width="672" /></p>
<p>and the statistics of the discretized PSO with considered transaction costs are:<br />
<img src="Master_Thesis_files/figure-html/9_10-1.png" width="672" /></p>
<p>It can be seen that increasing <span class="math inline">\(k\)</span> tends to reduce the average transaction cost in USD. Since each backtest depends on different previous portfolios, further backtests are needed to confirm this result. The absolute loss of <code>nav</code> between the results of the PSO without and with transaction costs for each <span class="math inline">\(k\)</span> can be found in the chart below:<br />
<img src="Master_Thesis_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Another interesting result is that the <code>solve.QP()</code> approach with a pool of 100 assets had a slightly higher performance than the SP500TR, suggesting that the asset pool in that particular period consists of assets that performed relatively well. This can be inspected in the follwing chart, comparing only the <code>solve.QP()</code> approach and the SP500TR:
<img src="Master_Thesis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-AkGa2022" class="csl-entry">
GANTI, AKHILESH. 2022. <span>“What Is a Brokerage Fee? How Fees Work, Types, and Expense.”</span> 2022. <a href="https://www.investopedia.com/terms/b/brokerage-fee.asp#:~:text=Realtors%20and%20real%20estate%20brokers,offer%20a%20fixed%2Dfee%20service.">https://www.investopedia.com/terms/b/brokerage-fee.asp#:~:text=Realtors%20and%20real%20estate%20brokers,offer%20a%20fixed%2Dfee%20service.</a>
</div>
<div id="ref-NySe2022" class="csl-entry">
nyse.com. 2022. <span>“New York Stock Exchange Price List 2022.”</span> 2022. <a href="https://www.nyse.com/publicdocs/nyse/markets/nyse/NYSE_Price_List.pdf">https://www.nyse.com/publicdocs/nyse/markets/nyse/NYSE_Price_List.pdf</a>.
</div>
</div>
<script src="script.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="pso-variations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AxelCode-R/Master-Thesis/edit/master/9_Real_Life_ITP_Example.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Master_Thesis.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
