<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Analytic Solver for Quadratic Programming Problems | Master-Thesis</title>
  <meta name="description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Analytic Solver for Quadratic Programming Problems | Master-Thesis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="AxelCode-R/Master-Thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Analytic Solver for Quadratic Programming Problems | Master-Thesis" />
  
  <meta name="twitter:description" content="This GitBook is an example of a GitBook for teaching. It can be adapted for specific courses. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Axel Roth" />


<meta name="date" content="2022-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="challenges.html"/>
<link rel="next" href="simple_particle_swarm_optimization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="my_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Master Thesis Axel Roth</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html"><i class="fa fa-check"></i><b>2</b> Software information and usage</a>
<ul>
<li class="chapter" data-level="2.1" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-version-and-packages"><i class="fa fa-check"></i><b>2.1</b> R-Version and Packages</a></li>
<li class="chapter" data-level="2.2" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#reproducibility"><i class="fa fa-check"></i><b>2.2</b> reproducibility</a></li>
<li class="chapter" data-level="2.3" data-path="software-information-and-usage.html"><a href="software-information-and-usage.html#r-functions"><i class="fa fa-check"></i><b>2.3</b> R-functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="open-data-sources.html"><a href="open-data-sources.html"><i class="fa fa-check"></i><b>3</b> Open Data Sources</a>
<ul>
<li class="chapter" data-level="3.1" data-path="open-data-sources.html"><a href="open-data-sources.html#r-functions-1"><i class="fa fa-check"></i><b>3.1</b> R-functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html"><i class="fa fa-check"></i><b>4</b> Mathematical Fundations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html#basic-operators"><i class="fa fa-check"></i><b>4.1</b> Basic Operators</a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html#return-calculation"><i class="fa fa-check"></i><b>4.2</b> Return calculation</a></li>
<li class="chapter" data-level="4.3" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html#markowitz-modern-portfolio-theory-mpt"><i class="fa fa-check"></i><b>4.3</b> Markowitz Modern Portfolio Theory (MPT)</a></li>
<li class="chapter" data-level="4.4" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html#portfolio-math"><i class="fa fa-check"></i><b>4.4</b> Portfolio Math</a></li>
<li class="chapter" data-level="4.5" data-path="mathematical-fundations.html"><a href="mathematical-fundations.html#created-r-functions"><i class="fa fa-check"></i><b>4.5</b> Created R-Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="activ-vs-passiv-investing.html"><a href="activ-vs-passiv-investing.html"><i class="fa fa-check"></i><b>5</b> Activ vs Passiv Investing</a></li>
<li class="chapter" data-level="6" data-path="challenges.html"><a href="challenges.html"><i class="fa fa-check"></i><b>6</b> Challenges of Passiv Investing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="challenges.html"><a href="challenges.html#mean-variance-portfolio-mvp"><i class="fa fa-check"></i><b>6.1</b> Mean-variance portfolio (MVP)</a></li>
<li class="chapter" data-level="6.2" data-path="challenges.html"><a href="challenges.html#index-tracking-portfolio-itp"><i class="fa fa-check"></i><b>6.2</b> Index-tracking portfolio (ITP)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html"><i class="fa fa-check"></i><b>7</b> Analytic Solver for Quadratic Programming Problems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#quadratic-programming-qp"><i class="fa fa-check"></i><b>7.1</b> Quadratic Programming (QP)</a></li>
<li class="chapter" data-level="7.2" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#qp-solver-from-quadprog"><i class="fa fa-check"></i><b>7.2</b> QP Solver from quadprog</a></li>
<li class="chapter" data-level="7.3" data-path="analytic-solver-for-quadratic-programming-problems.html"><a href="analytic-solver-for-quadratic-programming-problems.html#example-solving-mvp-with-solve.qp"><i class="fa fa-check"></i><b>7.3</b> Example: Solving MVP with <code>solve.QP</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simple_particle_swarm_optimization.html"><a href="simple_particle_swarm_optimization.html"><i class="fa fa-check"></i><b>8</b> Simple_Particle_Swarm_Optimization</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/AxelCode-R/Master-Thesis" target="blank">GitHub Repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Master-Thesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analytic-solver-for-quadratic-programming-problems" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Analytic Solver for Quadratic Programming Problems<a href="analytic-solver-for-quadratic-programming-problems.html#analytic-solver-for-quadratic-programming-problems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The benefits and drawbacks of analytic solvers for quadratic programming problems will be discussed in this chapter after chapter <a href="challenges">6</a>’s discussion of some common problems and their solutions. It would go beyond the scope of this thesis to explain the mathematical underlying principles of how a solver addresses quadratic problems, only the applications and analysis are discussed here. The foremost reason of addressing quadratic programming solvers is to use it as a benchmark for the PSO.</p>
<div id="quadratic-programming-qp" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Quadratic Programming (QP)<a href="analytic-solver-for-quadratic-programming-problems.html#quadratic-programming-qp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A quadratic program is a minimization problem of some function that returns a scalar and consists of an quadratic term and an linear term dependent on the variable of interest. Additionally can the problem be simply constrained by several linear inequalities that restrict the solution. The general formulation used, is to find <span class="math inline">\(x\)</span> that minimizes the following problem:
<span class="math display">\[
  min \ \frac{1}{2} \cdot x^T \times D \times x - d^T \times x
\]</span>
and holds under the linear constraints:
<span class="math display">\[
  A^T \times x &gt;= b_0
\]</span></p>
<p>Some other sources notate the problems with different signs or coefficients that are all exchangeable with the above stated problem. Additionally has the problem above the same notation that is used in the R-Package <code>quadprog</code> which will reduce substitution efforts. All modern programming languages do have many solvers for quadratic problem. They differ mostly in computational time on specific problems and the requirements. Some commercial QP-solvers do additionally accept more complex constraints, like absolute (e.g. <span class="math inline">\(|A^T \times x| &gt;= a_0\)</span>) or mixed-integer (e.g. <span class="math inline">\(x \in \mathbb{N}\)</span>). Specially the mixed-integer constraint problems will result in a enormously increase of memory.</p>
</div>
<div id="qp-solver-from-quadprog" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> QP Solver from quadprog<a href="analytic-solver-for-quadratic-programming-problems.html#qp-solver-from-quadprog" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The most common free QP-solver used in R is <a href="https://cran.r-project.org/web/packages/quadprog/quadprog.pdf">quadprog</a> which consists of a single function named <code>solve.QP</code>. Its implementation routine is the dual method of Goldfarb and Idnani that was published in <span class="citation">(<a href="#ref-GoId1982" role="doc-biblioref">Goldfarb and Idnani 1982</a>)</span> and <span class="citation">(<a href="#ref-GoId1983" role="doc-biblioref">Goldfarb and Idnani 1983</a>)</span>. It uses the above stated QP with the requirement that <span class="math inline">\(D\)</span> needs to be a symmetric positive definite matrix. It means that <span class="math inline">\(x^T D x &gt; 0 \ \forall \ x \in R^N\)</span> and <span class="math inline">\(D\in R^{N \times N}\)</span> which is equivalent to, all eigenvalues are bigger than null. In most cases this is not achieved by using the estimation of the covariance matrix <span class="math inline">\(\sum\)</span>, but its possible to find the nearest positive definite matrix of <span class="math inline">\(\sum\)</span> with the function <code>nearPD</code> from the <a href="https://cran.r-project.org/web/packages/Matrix/Matrix.pdf">Matrix</a> R-Package. The error that occurs is printed and often do not exceed a percentage change of elements above <span class="math inline">\(10^{-15} \ \%\)</span>, which is negligible for the context of this thesis. The <code>solve.QP</code> functions for a <span class="math inline">\(N\)</span> dimensional vector of interest, has the following arguments that can be found in the above stated formulation of a QP:</p>
<ul>
<li>Dmat: Symmetric positive definite matrix <span class="math inline">\(D \in R^{N \times N}\)</span> of the quadratic term.</li>
<li>dvec: Vector <span class="math inline">\(d \in R^{N}\)</span> of the linear term</li>
<li>Amat: Constraint matrix <span class="math inline">\(A\)</span></li>
<li>bvec: Constraint vector <span class="math inline">\(b_0\)</span></li>
<li>meq = 1: means that the first row of <span class="math inline">\(A\)</span> is treated as equality constraint (used to achieve fully invested portfolios)</li>
</ul>
<p>The return of <code>solve.QP</code> is a list and contains among other things the following attributes of interest:
+ solution: Vector containing the solution <span class="math inline">\(x\)</span> of the quadratic programming problem. (e.g. portfolio weights)
+ value: Scalar, the value of the quadratic function at the solution</p>
</div>
<div id="example-solving-mvp-with-solve.qp" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Example: Solving MVP with <code>solve.QP</code><a href="analytic-solver-for-quadratic-programming-problems.html#example-solving-mvp-with-solve.qp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section provides insights into the effect of diversification and the use of <code>solve.QP</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-1" aria-hidden="true" tabindex="-1"></a>returns_raw <span class="ot">&lt;-</span> <span class="fu">buffer</span>(</span>
<span id="cb22-2"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_yf</span>(</span>
<span id="cb22-3"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">tickers =</span> <span class="fu">c</span>(<span class="st">&quot;IBM&quot;</span>, <span class="st">&quot;GOOG&quot;</span>, <span class="st">&quot;AAPL&quot;</span>, <span class="st">&quot;MSFT&quot;</span>, <span class="st">&quot;AMZN&quot;</span>, <span class="st">&quot;NVDA&quot;</span>, <span class="st">&quot;JPM&quot;</span>, <span class="st">&quot;META&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;WMT&quot;</span>), </span>
<span id="cb22-4"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="st">&quot;2016-01-01&quot;</span>, </span>
<span id="cb22-5"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="st">&quot;2021-12-31&quot;</span></span>
<span id="cb22-6"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>returns, </span>
<span id="cb22-7"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AS_10_assets&quot;</span></span>
<span id="cb22-8"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># re-arrange: low var first</span></span>
<span id="cb22-11"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-11" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(returns_raw, var)</span>
<span id="cb22-12"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-12" aria-hidden="true" tabindex="-1"></a>returns_raw <span class="ot">&lt;-</span> returns_raw[, <span class="fu">order</span>(vars, <span class="at">decreasing =</span> F)]</span>
<span id="cb22-13"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-13" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> vars[<span class="fu">order</span>(vars, <span class="at">decreasing =</span> F)]</span>
<span id="cb22-14"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-16" aria-hidden="true" tabindex="-1"></a>mvp <span class="ot">&lt;-</span> <span class="cf">function</span>(returns, lambda){</span>
<span id="cb22-17"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-17" aria-hidden="true" tabindex="-1"></a>  tc <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb22-18"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-18" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">sapply</span>((<span class="dv">1</span><span class="sc">+</span>returns), prod)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(returns))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb22-19"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-20" aria-hidden="true" tabindex="-1"></a>    cov <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">nearPD</span>(<span class="fu">cov</span>(returns))<span class="sc">$</span>mat)</span>
<span id="cb22-21"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-22" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-23"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Dmat =</span> lambda <span class="sc">*</span> cov,</span>
<span id="cb22-24"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">dvec =</span> (<span class="dv">1</span><span class="sc">-</span>lambda) <span class="sc">*</span> mu,</span>
<span id="cb22-25"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amat =</span> <span class="fu">t</span>(<span class="fu">rbind</span>(</span>
<span id="cb22-26"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(returns)), <span class="co"># sum up to 1</span></span>
<span id="cb22-27"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">diag</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="fu">ncol</span>(returns), <span class="at">ncol=</span><span class="fu">ncol</span>(returns)) <span class="co"># long only</span></span>
<span id="cb22-28"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-28" aria-hidden="true" tabindex="-1"></a>      )),</span>
<span id="cb22-29"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">bvec =</span> <span class="fu">c</span>(</span>
<span id="cb22-30"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-30" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>, <span class="co"># sum up to 1</span></span>
<span id="cb22-31"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(returns)) <span class="co"># long only</span></span>
<span id="cb22-32"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-32" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb22-33"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">meq =</span> <span class="dv">1</span></span>
<span id="cb22-34"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-35"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-36"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-36" aria-hidden="true" tabindex="-1"></a>    qp <span class="ot">&lt;-</span> <span class="fu">solve.QP</span>(<span class="at">Dmat =</span> mat<span class="sc">$</span>Dmat, <span class="at">dvec =</span> mat<span class="sc">$</span>dvec, <span class="at">Amat =</span> mat<span class="sc">$</span>Amat, <span class="at">bvec =</span> mat<span class="sc">$</span>bvec, <span class="at">meq =</span> mat<span class="sc">$</span>meq)</span>
<span id="cb22-37"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-38"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-38" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-39"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-39" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mu&quot;</span> <span class="ot">=</span> mu <span class="sc">%*%</span> qp<span class="sc">$</span>solution,</span>
<span id="cb22-40"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;var&quot;</span> <span class="ot">=</span> <span class="fu">t</span>(qp<span class="sc">$</span>solution) <span class="sc">%*%</span> cov <span class="sc">%*%</span> qp<span class="sc">$</span>solution,</span>
<span id="cb22-41"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;composition&quot;</span> <span class="ot">=</span> <span class="fu">setNames</span>(qp<span class="sc">$</span>solution, <span class="fu">colnames</span>(returns))</span>
<span id="cb22-42"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-43"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span></span>
<span id="cb22-44"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e){<span class="cn">FALSE</span>})</span>
<span id="cb22-45"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-46"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-47"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(tc){</span>
<span id="cb22-48"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb22-49"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-49" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb22-50"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb22-51"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mu&quot;</span> <span class="ot">=</span> <span class="cn">NA</span>,</span>
<span id="cb22-52"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;var&quot;</span> <span class="ot">=</span> <span class="cn">NA</span>,</span>
<span id="cb22-53"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;composition&quot;</span> <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb22-54"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-54" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb22-55"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-56"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-57"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-58"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-59"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-59" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb22-60"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(returns_raw)){</span>
<span id="cb22-61"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-61" aria-hidden="true" tabindex="-1"></a>  returns <span class="ot">&lt;-</span> returns_raw[, <span class="dv">1</span><span class="sc">:</span>i]</span>
<span id="cb22-62"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(lambda <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)){</span>
<span id="cb22-63"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-63" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">mvp</span>(returns, lambda)</span>
<span id="cb22-64"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-65"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-65" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, <span class="fu">data.frame</span>(<span class="st">&quot;index&quot;</span><span class="ot">=</span>i, <span class="st">&quot;var&quot;</span><span class="ot">=</span>res<span class="sc">$</span>var, <span class="st">&quot;return&quot;</span> <span class="ot">=</span> res<span class="sc">$</span>mu))</span>
<span id="cb22-66"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-67"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-68"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-69"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-69" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb22-70"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(return)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-71"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-72"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">paste0</span>(<span class="st">&quot;n_&quot;</span>, index)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-73"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb22-74"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels=</span><span class="fu">paste0</span>(<span class="st">&quot;n_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(returns_raw))))</span>
<span id="cb22-75"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-76"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-77" aria-hidden="true" tabindex="-1"></a>max_show_sd <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb22-78"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb22-79"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_x =</span> <span class="fu">max</span>(var)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-80"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(max_x) <span class="sc">%&gt;%</span> <span class="fu">mean</span>() <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>()</span>
<span id="cb22-81"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-82"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> df, <span class="at">x=</span><span class="sc">~</span><span class="fu">sqrt</span>(var), <span class="at">y=</span><span class="sc">~</span>return, <span class="at">name=</span><span class="sc">~</span>name, <span class="at">mode=</span><span class="st">&quot;lines&quot;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">color =</span> <span class="sc">~</span>name, <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-83"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">xaxis=</span><span class="fu">list</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">min</span>(df<span class="sc">$</span>var))<span class="sc">*</span><span class="fl">0.9</span>, max_show_sd), <span class="at">title=</span><span class="st">&quot;standard deviation&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-84"><a href="analytic-solver-for-quadratic-programming-problems.html#cb22-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_save</span>()</span></code></pre></div>
<p><img src="Master_Thesis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-1" aria-hidden="true" tabindex="-1"></a>from <span class="ot">&lt;-</span> <span class="st">&quot;2016-01-01&quot;</span></span>
<span id="cb23-2"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-2" aria-hidden="true" tabindex="-1"></a>to <span class="ot">&lt;-</span> <span class="st">&quot;2021-12-31&quot;</span></span>
<span id="cb23-3"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-4" aria-hidden="true" tabindex="-1"></a>spx_composition <span class="ot">&lt;-</span> <span class="fu">buffer</span>(</span>
<span id="cb23-5"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_spx_composition</span>(),</span>
<span id="cb23-6"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AS_spx_composition&quot;</span></span>
<span id="cb23-7"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-10" aria-hidden="true" tabindex="-1"></a>pool_returns_raw <span class="ot">&lt;-</span> <span class="fu">buffer</span>(</span>
<span id="cb23-11"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_yf</span>(</span>
<span id="cb23-12"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tickers =</span> spx_composition <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date<span class="sc">&lt;=</span>to) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date<span class="sc">==</span><span class="fu">max</span>(Date)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Ticker), </span>
<span id="cb23-13"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> from, </span>
<span id="cb23-14"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> to</span>
<span id="cb23-15"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>returns, </span>
<span id="cb23-16"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AS_sp500_assets&quot;</span></span>
<span id="cb23-17"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-18"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-18" aria-hidden="true" tabindex="-1"></a>pool_returns_raw <span class="ot">&lt;-</span> pool_returns_raw[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(pool_returns_raw))<span class="sc">==</span><span class="dv">0</span>]</span>
<span id="cb23-19"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-21" aria-hidden="true" tabindex="-1"></a>bm_returns <span class="ot">&lt;-</span> <span class="fu">buffer</span>(</span>
<span id="cb23-22"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_yf</span>(<span class="at">tickers =</span> <span class="st">&quot;%5EGSPC&quot;</span>, <span class="at">from =</span> from, <span class="at">to =</span> to)<span class="sc">$</span>returns, </span>
<span id="cb23-23"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;AS_sp500&quot;</span></span>
<span id="cb23-24"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(., <span class="st">&quot;S&amp;P 500&quot;</span>)</span>
<span id="cb23-25"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-27" aria-hidden="true" tabindex="-1"></a>itp <span class="ot">&lt;-</span> <span class="cf">function</span>(pool_returns, bm_returns){</span>
<span id="cb23-28"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-28" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb23-29"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dmat =</span> <span class="fu">cov</span>(pool_returns),</span>
<span id="cb23-30"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">dvec =</span> <span class="fu">cov</span>(pool_returns, bm_returns),</span>
<span id="cb23-31"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amat =</span> <span class="fu">t</span>(<span class="fu">rbind</span>(</span>
<span id="cb23-32"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(pool_returns)), <span class="co"># sum up to 1</span></span>
<span id="cb23-33"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">diag</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="fu">ncol</span>(pool_returns), <span class="at">ncol=</span><span class="fu">ncol</span>(pool_returns)) <span class="co"># long only</span></span>
<span id="cb23-34"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-34" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb23-35"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">bvec =</span> <span class="fu">c</span>(</span>
<span id="cb23-36"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-36" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, <span class="co"># sum up to 1</span></span>
<span id="cb23-37"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(pool_returns)) <span class="co"># long only</span></span>
<span id="cb23-38"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-39"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">meq =</span> <span class="dv">1</span></span>
<span id="cb23-40"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-41"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-42"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-42" aria-hidden="true" tabindex="-1"></a>  qp <span class="ot">&lt;-</span> <span class="fu">solve.QP</span>(<span class="at">Dmat =</span> mat<span class="sc">$</span>Dmat, <span class="at">dvec =</span> mat<span class="sc">$</span>dvec, <span class="at">Amat =</span> mat<span class="sc">$</span>Amat, <span class="at">bvec =</span> mat<span class="sc">$</span>bvec, <span class="at">meq =</span> mat<span class="sc">$</span>meq)</span>
<span id="cb23-43"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-44" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb23-45"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;var&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">var</span>(pool_returns <span class="sc">%*%</span> qp<span class="sc">$</span>solution <span class="sc">-</span> bm_returns)),</span>
<span id="cb23-46"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;solution&quot;</span> <span class="ot">=</span> <span class="fu">setNames</span>(qp<span class="sc">$</span>solution, <span class="fu">colnames</span>(pool_returns))</span>
<span id="cb23-47"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-48"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-49"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-50"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-51"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-51" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-52"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">rev</span>(<span class="fu">seq</span>(<span class="dv">5</span>, <span class="fu">ncol</span>(pool_returns_raw), <span class="dv">5</span>))){</span>
<span id="cb23-53"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="fu">ncol</span>(pool_returns_raw)){</span>
<span id="cb23-54"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-54" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">itp</span>(pool_returns_raw, bm_returns)</span>
<span id="cb23-55"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-55" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb23-56"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-56" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">itp</span>(pool_returns_raw[, <span class="fu">names</span>(<span class="fu">sort</span>(temp<span class="sc">$</span>solution, <span class="at">decreasing =</span> T)[<span class="dv">1</span><span class="sc">:</span>i])], bm_returns)</span>
<span id="cb23-57"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-58"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-58" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(res, <span class="fu">data.frame</span>(<span class="st">&quot;N&quot;</span><span class="ot">=</span>i, <span class="st">&quot;var&quot;</span><span class="ot">=</span>temp<span class="sc">$</span>var, <span class="st">&quot;sd&quot;</span><span class="ot">=</span><span class="fu">sqrt</span>(temp<span class="sc">$</span>var), <span class="at">row.names =</span> <span class="cn">NULL</span>))</span>
<span id="cb23-59"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-60"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-61"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data=</span>res, <span class="at">x=</span><span class="sc">~</span>N, <span class="at">y=</span><span class="sc">~</span>sd, <span class="at">mode=</span><span class="st">&quot;lines&quot;</span>, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-63"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis=</span><span class="fu">list</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">mean</span>(<span class="fu">max</span>(res<span class="sc">$</span>sd),<span class="fu">mean</span>(res<span class="sc">$</span>sd)) ))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-64"><a href="analytic-solver-for-quadratic-programming-problems.html#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_save</span>()</span></code></pre></div>
<p><img src="Master_Thesis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-GoId1982" class="csl-entry">
Goldfarb, D., and A. Idnani. 1982. <span>“Dual and Primal-Dual Methods for Solving Strictly Convex Quadratic Programs.”</span>
</div>
<div id="ref-GoId1983" class="csl-entry">
———. 1983. <span>“A Numerically Stable Dual Method for Solving Strictly Convex Quadratic Programs.”</span>
</div>
</div>
<script src="script.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="challenges.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple_particle_swarm_optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AxelCode-R/Master-Thesis/edit/master/6_Analytical_Solver.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Master_Thesis.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
